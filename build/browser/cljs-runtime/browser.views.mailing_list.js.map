{"version":3,"sources":["browser/views/mailing_list.cljs"],"mappings":";;AAMA,AAAKA,wCAAW,gDAAA,hDAACC;AAEjB,uCAAA,vCAAMC,sFAAWC,IAAIC;AAArB,AACE,OAACC,mDAAML,sCAAWM,gBAAMH,IAAI,AAAA,AAAIC;;AAElC,AAAKG,sCAAS,8BAAA,wBAAA,pCAAIC;AAElB,wCAAA,xCAAMC,wFAAYC,WAAWC;AAA7B,AACE,AAAiBA;;AACjB,qFAAA,2DAAA,uDAAA,vMAACN,0DAAMK,WAAWJ,gMAED,mEAAIM,nDAAsB,sEAAA,tEAACC,hBAAeC;;AAC3D,OAAA,gMAAA,hMAAI,AAACC,sDAAW,qCAAA,pCAAKR,iFAA6C,qBAAA,AAAAS,gBAAKN,rCAAWO;AAAlF,AACW,wCAAA,2CAAA,uDAAA,nIAACC,sBAAOR;UACR,WAAKS;AAAL,AAEE,4FAAA,yDAAA,uDAAA,2DAAA,hQAACd,0DAAMK,WAAWJ;;;AAEjC,kCAAA,lCAAMc;AAAN,AAAA,0FAAA,sDAAA,2CAAA,wDAAA,gBAAA,oMAAA,mFAAA,uDAAA,2CAAA,oDAAA,QAAA,wDAAA,yBAAA,UAAA,mFAAA,sDAAA,2CAAA,kDAAA,QAAA,qDAAA,QAAA,wDAAA,iBAAA,6DAAA,KAAA,v4BAEqB,AAACC,gDAAQZ,sCAAWT,u2BAMrB,iBAAAsB,eAAA,AAAAN,gBAAEhB;AAAF,AAAA,QAAAsB,6CAAAA,2CAAA,2EAAAA,uBAAA;KARpB,qPAAA,mFAAA,uDAAA,2CAAA,oDAAA,OAAA,wDAAA,yBAAA,UAAA,mFAAA,uDAAA,qBAAA,mFAAA,sDAAA,2CAAA,kDAAA,OAAA,qDAAA,OAAA,wDAAA,iBAAA,lhCASwB,qFAAA,rFAACD,gDAAQnB,whCAKb,iBAAAqB,eAAA,AAAAP,gBAAEhB;AAAF,AAAA,QAAAuB,6CAAAA,2CAAA,wDAAAA,uBAAA;KAdpB,kOAAA,mFAAA,yDAAA,2CAAA,wDAAA,SAAA,3ZAewB,qFAAA,rFAACF,gDAAQnB,yaACM,iBAAAsB,eAAA,AAAAR,gBAAEhB;AAAF,AAAA,QAAAwB,6CAAAA,2CAAA,8DAAAA,uBAAA;aAhBvC,iBAiBG,kBAAM,iBAAAC,eAAA,AAAAT,gBAAEhB;AAAF,AAAA,QAAAyB,6CAAAA,2CAAA,0DAAAA,uBAAA;MAAN,AAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,iEAAA,yBAAA,kCAAA,MAEA,kBAAM,iBAAAC,eAAA,AAAAV,gBAAEhB;AAAF,AAAA,QAAA0B,6CAAAA,2CAAA,4DAAAA,uBAAA;MAAN,AAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,iEAAA,iBAAA,wDAAA,mBAAA,qHAAA;;AAIH,kCAAA,lCAAMC,4EAAMC;AAAZ,AACE,4CAAA,gBAAA,mFAAA,mDAAA,mFAAA,kDAAA,2CAAA,wDAAA,uBAAA,uBAAA,mFAAA,mDAAA,2CAAA,wDAAA,uCAAA,mFAAA,8CAAA,2CAAA,wDAAA,gBAAA,0FAAA,mFAAA,uDAAA,zrCAACC,myCAOC,AAACT","names":["browser.views.mailing-list/form-state","reagent.core.atom","browser.views.mailing-list/on-change","key","event","cljs.core.swap_BANG_","cljs.core/assoc","browser.views.mailing-list/api-base","js/goog.DEBUG","browser.views.mailing-list/send-email","form-state","ev","js/navigator.language","clojure.string.split","cljs.core/first","js/module$node_modules$axios$dist$browser$axios_cjs.post","cljs.core/deref","cljs.core/clj->js","cljs.core/reset!","error","browser.views.mailing-list/form","cljs.core.partial","fexpr__33765","fexpr__33766","fexpr__33767","fexpr__33769","fexpr__33771","browser.views.mailing-list/main","app-state","browser.views.helpers/page-container"],"sourcesContent":["(ns browser.views.mailing-list\n  (:require [browser.views.helpers :refer [page-container]]\n            [reagent.core :as r]\n            [axios :as axios]\n            [clojure.string :as str]))\n\n(def form-state (r/atom {}))\n\n(defn on-change [key event]\n  (swap! form-state assoc key (-> event .-target .-value)))\n\n(def api-base (if goog.DEBUG \"http://localhost:9000\" \"\"))\n\n(defn send-email [form-state ev]\n  (.preventDefault ev)\n  (swap! form-state assoc\n         :sending? true\n         :language (-> js/navigator.language (str/split \"-\") first))\n  (.. (axios/post (str api-base \"/.netlify/functions/mailing-list\") (-> @form-state clj->js))\n      (then #(reset! form-state {:sent? true}))\n      (catch (fn [error]\n               #_(-> error .-response js/console.log)\n               (swap! form-state assoc :error? true :sending? false)))))\n\n(defn form []\n  [:form {:class \"contact__form\"\n          :on-submit (partial send-email form-state)}\n   [:label {:for \"email\" :class \"contact__label\"} \"Email *\"\n    [:input {:id \"email\"\n             :type \"email\"\n             :class \"contact__input\"\n             :required true\n             :value (@form-state :email_address)\n             :on-change (partial on-change :email_address)}]]\n   [:label {:for \"name\" :class \"contact__label\"} \"Nombre \" [:small \"(opcional)\"]\n    [:input {:id \"name\"\n             :type \"text\"\n             :class \"contact__input\"\n             :value (@form-state :name)\n             :on-change (partial on-change :name)}]]\n   [:button {:class \"button\" :disabled (@form-state :sending?)} \"Enviar\"]\n   (when (@form-state :sent?) [:div {:style {:text-align \"center\"}}\n                               \"Thanks for subscribing!\"])\n   (when (@form-state :error?)\n     [:div {:style {:text-align \"center\"} :class \"text-red\"}\n      \"There was an error when trying to subscribe or maybe you are already subscribed. If not, please try again.\"])])\n\n(defn main [app-state]\n  (page-container\n   \"contact pt-40\"\n   [:div\n    [:h1 {:class \"contact__ttl\"} \"Mailing list\"]\n    [:div {:class \"contact__p mb-20 text-center\" }\n     [:p {:class \"mb-20\"} \"Suscr\u00edbete para recibir nueva m\u00fasica, noticias, textos y otras cosas.\"]\n     [:small \"Me compromento a mandar s\u00f3lo contenido de calidad, aproximadamente cada dos meses.\"]]\n    (form)]))\n"]}